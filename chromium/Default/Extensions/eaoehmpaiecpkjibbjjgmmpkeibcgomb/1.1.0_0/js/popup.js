function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Popup=function(){"use strict";function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"sendMessage",value:function(e,t){chrome.runtime.sendMessage(e,t)}},{key:"createDownloadSection",value:function(e){return'<li class="video">         <a class="play-button" href="'+e.url+'" target="_blank"></a>         <div class="title" title="'+e.fileName+'">'+e.fileName+'</div>         <a class="download-button" href="'+e.url+'" data-file-name="'+e.fileName+e.extension+'">Download - '+Math.floor(100*e.size/1024/1024)/100+' MB</a>        <div class="sep"></div>        </li>'}},{key:"getVideoList",value:function(){var n=this,o=$("#video-list");chrome.tabs.query({active:!0,currentWindow:!0},function(e){n.sendMessage({message:"get-video-links",tabId:e[0].id},function(e){if("url"in e)if(/^[^:]*:(?:\/\/)?(?:[^\/]*\.)?youtube.com\/.*$/.test(e.url))n.youtubeAlert();else{var t=e.videoLinks;if(0==t.length)return $("#no-video-found").css("display","block").html(chrome.i18n.getMessage("notfound")),void o.css("display","none");$("#no-video-found").css("display","none"),o.css("display","block"),t.forEach(function(e){o.append(n.createDownloadSection(e))})}})})}},{key:"youtubeAlert",value:function(){$("#no-video-found").css("display","block").html(chrome.i18n.getMessage("disableyoutube"))}},{key:"serverSideQuery",value:function(){var t=this,n="https://musicdownload.zone/",e=$("#text-input").val();if(-1!==e.indexOf("youtube.com"))return this.youtubeAlert();""!=e?(n=n+"download?src=adon&url="+encodeURI(e),window.open(n)):chrome.tabs.query({active:!0,currentWindow:!0},function(e){/^[^:]*:(?:\/\/)?(?:[^\/]*\.)?youtube.com\/.*$/.test(e[0].url)?t.youtubeAlert():(n=n+"download?src=adon&url="+e[0].url,window.open(n))}),$("#text-input").val("")}},{key:"downloadVideo",value:function(){var t=this;$("body").on("click",".download-button",function(e){e.preventDefault(),t.sendMessage({message:"download-video-link",url:e.target.href,fileName:e.target.dataset.fileName})})}},{key:"isIE",value:function(){var e=window.navigator.userAgent;return 0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")}},{key:"localizeHtmlPage",value:function(){for(var e=document.getElementsByTagName("html"),t=0;t<e.length;t++){var n=e[t],o=n.innerHTML.toString(),i=o.replace(/__MSG_(\w+)__/g,function(e,t){return t?chrome.i18n.getMessage(t):""});i!=o&&(n.innerHTML=i)}}},{key:"run",value:function(){var n=this;this.localizeHtmlPage(),this.getVideoList(),this.downloadVideo(),$("body").on("click","#query-button",function(e){n.serverSideQuery()}),$("body").on("keypress","#text-input",function(e){13==e.which&&n.serverSideQuery()}),$("body").on("paste","#text-input",function(e){var t="",t=n.isIE()?window.clipboardData.getData("text"):e.originalEvent.clipboardData.getData("text/plain");$("#text-input").val(t),n.serverSideQuery()})}}]),e}(),popup=new Popup;$(document).ready(function(){popup.run()});